# KG Vejle TumorBoard WGS DNA and total RNA pipeline


## General info:
Requires a samplesheet containing 5 columns in specific order (tab separated), without headerline:
1) caseID, 2) NPN normal, 3) NPN tumor , 4) NPN tumor RNA, 5) PCGR tumor value


The PCGR tumorcodes can be found at the end of this readme.

Example samplesheet:

    johnDoe 112217976652	111184925465	111184925473    23

The script will automatically look for fastq or cram files in subfolders at the KGVejle dataarchive location. Theres no need to copy or move any input data.

The user can point to a specific folder containing input data using the --fastq or --cram option. 
This is only needed if input data exists outside the data archive (e.g. if data are in personal folders or stored at other KG Vejle servers).

Using the --default option will search for DNA CRAM files (which should be generated automatically by KG Vejle standard preprocessing pipelines), and for RNA-seq fastq files.


## Usage examples:

Analyze the cases in samplesheet.txt, starting with CRAM files (WGS DNA), and fastq files (RNA-seq). let the script find the relevant files at the archive:

        nextflow run KGVejle/tumorboard -r main --samplesheet /path/to/samplesheet.txt --default

Analyze the cases in samplesheet.txt, starting with CRAM files, manually select folder with input data (CRAM):

        nextflow run KGVejle/tumorboard -r main --samplesheet /path/to/samplesheet.txt --cram /path/to/cramfolder/

Analyze the cases in samplesheet.txt, starting with Fastq files, let the script find the relevant fastqfiles at the archive:

        nextflow run KGVejle/tumorboard -r main --samplesheet /path/to/samplesheet.txt --fastqInput

Analyze the cases in samplesheet.txt, starting with Fastq files, manually select folder with input data (Fastq):

        nextflow run KGVejle/tumorboard -r main --samplesheet /path/to/samplesheet.txt --fastq /path/to/fastqfolder/



## Main options:

      --help                print this help message

      --outdir              Select which folder to write output to.
                                Default: caseID from samplesheet

      --samplesheet         path to case samplesheet. Can contain multiple patients/cases (each case in a separate line). 

      --server              Select which server the analysis is performed on (lnx01 or other)
                                Default: null (only set this option if using lnx01 - defaults to all other servers)

      --fastq               Path to dir with fastq files
                                Default: data storage dirs KG Vejle archive

      --keepwork            keep the workfolder generated by the nextflow script.
                                Default: not set - removes the Work folder

      --nomail              Does not send a mail-message when completing a script
                                Default: not set - sends mail message if the user is mmaj or raspau and only if the script has been running longer than 20 minutes.


    QC options:
      --skipQC              Skip all QC steps except MultiQC
      --qualimap            Run qualimap BAMQC
                                Default: Do not run BAMQC (timeconsuming!)
      --dupradar            Run Dupradar (not available this version of the script)
                                Default: Do not run Dupradar (timeconsuming!)

    Analysis selection options (not set by default):
      --skipDNA             Do not run DNA analysis (only RNA)
      --skipRNA             Do not run RNA analysis (only DNA)  
      --skipWGS             Do not run analyses that require WGS data (e.g. HRD)
      --skipFusion          Do not call Fusions
      --skipAltSplicing     Do not call alternative splicevariants (e.g. exon skipping)
      --skipExpression      Do not analyse geneexpression (i.e. skip RSEM and isofox)


        
## PCGR tumor codes:
    1=Adrenal Gland
    2=Ampulla of Vater
    3=Biliary Tract
    4 = Bladder/Urinary Tract
    5 = Bone
    6 = Breast
    7 = Cervix
    8 = CNS/Brain
    9 = Colon/Rectum
    10 = Esophagus/Stomach
    11 = Eye
    12 = Head and Neck
    13 = Kidney
    14 = Liver
    15 = Lung
    16 = Lymphoid
    17 = Myeloid
    18 = Ovary/Fallopian Tube
    19 = Pancreas
    20 = Peripheral Nervous System
    21 = Peritoneum
    22 = Pleura
    23 = Prostate
    24 = Skin
    25 = Soft Tissue
    26 = Testis
    27 = Thymus
    28 = Thyroid
    29 = Uterus
    30 = Vulva/Vagina

